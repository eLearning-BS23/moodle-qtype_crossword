define ("qtype_crossword/crossword",["jquery"],function(a){return{setup:function setup(b){var Y=[];function c(){return!1}function d(){return!0}function e(){return!0}function f(){return!0}function g(){a(".word-clue").click(function solvefunction(){a("#solution-answer").val("");a("#answer-results").hide();a("#answer-results").html("");var b=a(this).attr("data-word"),c="false"==a(this).attr("data-across")?"Down":"Across";a("#position-and-clue").html("<b>"+c+"</b> : "+a(this).attr("data-clue"));a("#answer-form").show();if(a(this).children("span").attr("data-solved")){a("#answer-button").attr("disabled",!0);a("#answer-results").show();a("#answer-results").html("You have already solved this problem.");a("#solution-answer").val(b)}else{a("#solution-answer").attr("maxlength",b.length);a("#answer-button").attr("data-word",b);var d=a(this).attr("data-x");a("#answer-button").attr("data-x",d);var e=a(this).attr("data-y");a("#answer-button").attr("data-y",e);var f=a(this).attr("data-across");a("#answer-button").attr("data-across",f);a("#solution-answer").focus();a("#answer-button").attr("disabled",!1)}return!1});a("#cancel-button").click(function closesolvefunction(){a("#answer-results").hide();a("#answer-form").hide();return!1});a("#answer-button").click(function answerfunction(){var b=a(this).attr("data-word"),c=a("#solution-answer").val().toLowerCase();if(c==b){var d=a(this).attr("data-across"),e=parseInt(a(this).attr("data-x"),10),f=parseInt(a(this).attr("data-y"),10);if(d&&"false"!=d){for(var g=0;g<c.length;g++){var h=f+g,j="letter-position-"+e+"-"+h;a("#"+j).text(c[g])}}else{for(var g=0;g<c.length;g++){var k=e+g,j="letter-position-"+k+"-"+f;a("#"+j).text(c[g])}}a("#"+b+"-listing").addClass("strikeout");a("#"+b+"-listing").attr("data-solved",!0);a("#answer-form").hide()}else{if(!a("#answer-results").is(":visible")){a("#answer-results").show();a("#answer-results").html("Incorrect Answer, Please Try Again")}}return!1});a("#reveal-answer-button").click(function revealanswerfunction(){var b=a(this).attr("data-word"),c=a(this).attr("data-across"),d=parseInt(a(this).attr("data-x"),10),e=parseInt(a(this).attr("data-y"),10);if(c&&"false"!=c){for(var f=0;f<b.length;f++){var g=e+f,h="letter-position-"+d+"-"+g;a("#"+h).text(b[f])}}else{for(var f=0;f<b.length;f++){var j=d+f,h="letter-position-"+j+"-"+e;a("#"+h).text(b[f])}}a("#"+b+"-listing").addClass("red-strikeout");a("#"+b+"-listing").attr("data-solved",!0);a("#answer-form").hide()})}function h(b,c,d){var e=b.across,g=b.down;if(f()){e=X(e);g=X(g)}var h=j(e),k=j(g,e,h),l=i(h,c,!0,d),m=i(k,c,!1,d);a("#left-list").append(l);a("#right-list").append(m)}function i(a,b,c,d){for(var e=Object.keys(a),f="<ul>",g=0;g<e.length;g++){var h=e[g],j=a[h],k=j.word,l=j.coordinates,m=b[k],n=d[k];f+="<input type=\"text\" name=\""+n.replace(/"/g,"&quot;")+"\" onblur=\"onBlurFuntion(this.value,"+l[0]+","+l[1]+","+c+")\"";f+="data-word=\""+k.replace(/"/g,"&quot;")+"\" ";f+="data-clue=\""+m.replace(/"/g,"&quot;")+"\" ";f+="data-x=\""+l[0]+"\" ";f+="data-y=\""+l[1]+"\" ";f+="data-across=\""+c+"\" ";f+=">";f+=h+" : ";f+="<span id=\"";f+=k+"-listing";f+="\" ";f+="class=\"linkable\">";f+=m;f+="</span>";f+="</input>"}f+="</ul>";return f}function j(b,c,d){for(var e=[],f=0,g=0;g<b.length;g++){f++;var h=b[g],j=h.word,l=h.position,m=k(l,c,d);fillnumber=f;if(m){fillnumber=m}var n="<div class=\"background-text\"><span class=\"crossword-grid-cell-number\">"+fillnumber+"</span></div>",o;o=a("#cell-position-"+l[0]+"-"+l[1]);if(o&&a(o).attr("id")){a(o).prepend(n)}e[f]={word:j,coordinates:l}}return e}function k(a,b,c){if(!b||!b.length||!c||!c.length){return!1}for(var d=0;d<b.length;d++){var e=b[d],f=e.position;if(f[0]==a[0]&&f[1]==a[1]){return l(e.word,c)}}return!1}function l(a,b){for(var c=Object.keys(b),d=0;d<c.length;d++){var e=c[d],f=b[e];if(f.word==a){return e}}}function m(b){for(var d=z(b),e=B(b),f=a("<table class=\"puzzle\" border=\"1\" cellpadding=\"0\" cellspacing=\"0\"></table>"),g=0,h;g<e;g++){h="<tr class=\"letter-row\">";for(var k=0,l;k<d;k++){l="letter-cell";if(!b[g][k]||" "==b[g][k]){l+=" blank-cell"}h+="<td id=\"cell-position-"+g+"-"+k+"\" class=\"relative-position "+l+"\">";h+="<span class=\"letter-text\" id=\"letter-position-"+g+"-"+k+"\">";if(c()&&b[g][k]&&" "!=b[g][k]){h+=b[g][k]}h+="</span>";h+="</td>"}h+="</tr>";a(f).append(h)}a("#root").append(f);return!0}function n(a){for(var b=[],c=[],d=0;d<a.length;d++){var e=a[d],f=e.across,g=e.word,h=e.matrixpositions,j={word:g,position:h[g]};delete h[g];if(f){if("(unmatched)"!=g){b.push(j)}c=o(c,h)}else{if("(unmatched)"!=g){c.push(j)}b=o(b,h)}}return{across:b,down:c}}function o(a,b){for(var c=Object.keys(b),d=0;d<c.length;d++){var e=c[d],f=b[e];a.push({word:e,position:f})}return a}function p(a){for(var b=a.shift(),c=b.matrix,d=[{matrixpositions:b.matrixpositions,across:b.across,word:b.word}],e=0;e<a.length;e++){var f=a[e],g=f.matrix,h=f.matrixpositions,k=f.across,l=f.word;console.log("BT: BUILD BLOCK GRAPH...|"+e+"|"+l+"|");console.info(h);var m=z(c),n=B(c),o=x(c,g,m,n),p=!1;if(!o){for(var y=!1,C=[],D=99999999,E=0,F;E<c.length;E++){F=s(c[E]);if(0<F.length&&F.length<D){var G=[F.length,E+e],H=t(c,g,G);if(H){D=A(H);y=H;C=G;canmutate=!0;var I=1;while(canmutate&&0<=F.length-I){console.log("BT: Across ALPHA.");G=[F.length-I,E+e];var J=t(c,g,G);if(J){D=A(J);y=J;C=G;I++}else{canmutate=!1;I--}}var K=1;while(0<E+e-K){G=[F.length-I,E+e-K];var J=t(c,g,G);if(J){D=A(J);y=J;C=G}K++}K--;canmutate=!0;var I=1;while(canmutate&&0<=F.length-I){G=[F.length-I,E+e-K];var J=t(c,g,G);if(J){D=A(J);y=J;C=G;I++}else{canmutate=!1;I--}}}}}if(y){c=y;console.info(h);h=q(h,[C[1],C[0]]);d.push({matrixpositions:h,across:k,word:l});p=!0}}if(o||!p){console.log("BT: Vertical ALPHA.");var L=c.length;fullmatrixbottom=c[c.length-1];for(var E=0,M;E<m;E++){M=g[0];if(v(fullmatrixbottom,M)){c=u(c,g);G=[L,E];h=q(h,G);d.push({matrixpositions:h,across:k,word:l});E=m;p=!0}else{g=w(g)}}if(!p){r(g);G=[c.length+1,0];g=N({matrix:g}).matrix;c.push("");c=u(c,g);h=q(h,G);console.info(h);d.push({matrixpositions:h,across:k,word:l})}}c=N({matrix:c}).matrix}var O={matrix:c,matrixpositions:d};return O}function q(a,b){for(var c=Object.keys(a),d=0;d<c.length;d++){var e=c[d],f=a[e];f[0]+=b[0];f[1]+=b[1]}return a}function r(a){console.log("Viewing puzzle from...|"+arguments.callee.caller.name+"|");console.info(JSON.stringify(a).replace(/,/g,",\n"))}function s(a){if(!a){return""}return a.replace(/\s+$/,"")}function t(a,b,c){if(0==c[0]||0==c[1]){return!1}originalfullmatrix=a;a.length+b.length;a=a.slice();for(var d=0,e;d<b.length;d++){e=b[d];for(var f=0;f<e.length;f++){var g=c[0],h=c[1];g+=f;h+=d;if(!a[h]){a[h]=""}if(a[h]&&a[h][g]&&" "!=a[h][g]&&" "!=b[d][f]){return!1}else{if(" "!=b[d][f]){if(originalfullmatrix[h-1]&&originalfullmatrix[h-1][g]&&" "!=originalfullmatrix[h-1][g]){return!1}if(originalfullmatrix[h+1]&&originalfullmatrix[h+1][g]&&" "!=originalfullmatrix[h+1][g]){return!1}if(originalfullmatrix[h]&&originalfullmatrix[h][g-1]&&" "!=originalfullmatrix[h][g-1]){return!1}if(originalfullmatrix[h]&&originalfullmatrix[h][g+1]&&" "!=originalfullmatrix[h][g+1]){return!1}}}while(!a[h][g]){a[h]+=" "}if(" "!=b[d][f]){a[h]=E(b[d][f],a[h],g)}}}return a}function u(a,b){for(var c=a.length,d=0;d<b.length;d++){a[c+d]=b[d]}return a}function v(a,b){var c;if(a[b.length]&&" "==a[b.length]){return!1}if(a.length>b.length){c=b;altrowtocheck=a}else{c=a;altrowtocheck=b}for(var d=0;d<c.length;d++){if(c[d]&&altrowtocheck[d]){if(" "!=c[d]&&" "!=altrowtocheck[d]){return!1}}}return!0}function w(a){for(var b=0;b<a.length;b++){a[b]=" "+a[b]}return a}function x(a,b,c,d){if(a.length<=b.length){return!0}else if(d<c){return!0}else if(c<d){return!1}return y()}function y(){return .5<Math.random()?!0:!1}function z(a){for(var b=0,c=0,d;c<a.length;c++){d=a[c];if(d&&d.length&&d.length>b){b=d.length}}return b}function A(a){for(var b=999999,c=0,d;c<a.length;c++){d=a[c];if(d&&d.length<b){b=d.length}}return b}function B(a){return a.length}function C(a){var b=[];for(var c in a){if(!a.hasOwnProperty(c)||"(unmatched)"==c)continue;var d=a[c],f=L(d),g=!0;if(e()){g=y()}var h=[],j=[];if(g){h[f-1]=c;j[c]=[f-1,0];for(var k=0;k<d.length;k++){var l=d[k],m=l[0],n=l[1],o=J(h,c,n,f-2),p=H(m,n);j[m]=[f-p-1,o];h=G(h,m,f-p-1,o)}}else{h=K(h,c,f+1,0);j[c]=[0,f];for(var k=0;k<d.length;k++){var l=d[k],m=l[0],n=l[1],o=I(h,c,n,f-1),p=H(m,n);j[m]=[o,f-p];h=F(h,m,o,f-p)}}var q={matrix:h,matrixpositions:j,across:g,word:c};b.push(q)}if(a["(unmatched)"]){var q=D(a["(unmatched)"]);b.push(q)}return b}function D(a){var b=!0;if(e()){b=y()}var c=L(a),d=[],f=[];if(b){for(var g=0,h;g<a.length;g++){h=a[g];d[g]=h;f[h]=[0,g]}}else{for(var g=0,h;g<a.length;g++){h=a[g];d=G(d,h,0,g);f[h]=[g,0]}}var j={matrix:d,matrixpositions:f,across:!b,word:"(unmatched)"};return j}function E(a,b,c){if(!a){a=" "}return b.substr(0,c)+a+b.substr(c+1)}function F(a,b,c,d){for(var e=0,f;e<b.length;e++){f=e+d;if(!a[c]){a[c]=""}letters=a[c];if(letters.length<f){while(letters.length<f){letters+=" "}letters+=b[e]}else{letters=E(b[e],letters,f)}a[c]=letters}return a}function G(a,b,c,d){for(var e=0,f;e<b.length;e++){f=e+c;if(!a[f]){a[f]=""}letters=a[f];if(letters.length<d){while(letters.length<d){letters+=" "}letters+=b[e]}else{letters=E(b[e],letters,d)}a[f]=letters}return a}function H(a,b){for(var c=0;c<a.length;c++){if(a[c]==b){return c}}return!1}function I(a,b,c,d){for(var e=0,f;e<b.length;e++){f=b[e];if(!a[e]){a[e]=""}if(c==f&&(!a[e][d]||" "==a[e][d])&&(!a[e][d+2]||" "==a[e][d+2])){return e}}return!1}function J(a,b,c,d){for(var e=0,f;e<b.length;e++){f=b[e];if(!a[d]){a[d]=""}if(c==f&&(!a[d][e]||" "==a[d][e])&&(!a[d+2]||!a[d+2][e]||" "==a[d+2][e])){return e}}return!1}function K(a,b,c){for(var d=Array(c).join(" "),e=0;e<b.length;e++){a[e]=d+b[e]}return a}function L(a){for(var b=0,c=0;c<a.length;c++){var d=a[c],e=d[0].length;if(e>b){b=e}}return b}function M(a){for(var b=0;b<a.length;b++){var c=a[b],d=c.matrix;c=N(c);a[b]=c}return a}function N(a){a=R(a);a=O(a);a=S(a);a=T(a);return a}function O(b){for(var c=b.matrix,d=b.matrixpositions,e=b.across,f=c.length,g=0;g<f;g++){var h=c[g],j=a.trim(h);if(!h||!j.length){c.splice(g,1);d=P(d);g--;f--}else{g=f}}b.matrix=c;b.matrixpositions=d;return b}function P(a){if(!a){return a}crosswordblockwords=Object.keys(a);for(var b=0,c;b<crosswordblockwords.length;b++){c=crosswordblockwords[b];a[c][0]--}return a}function Q(a){if(!a){return a}crosswordblockwords=Object.keys(a);for(var b=0,c;b<crosswordblockwords.length;b++){c=crosswordblockwords[b];a[c][1]--}return a}function R(b){for(var c=b.matrix,d=b.matrixpositions,e=b.across,f=c.length,g=f-1;0<=g;g--){var h=c[g],j=a.trim(h);if(!j.length){c.splice(g,1)}else{g=-1}}b.matrix=c;b.matrixpositions=d;return b}function S(a){var b=a.matrix,c=a.matrixpositions,d=a.across,e=b.length,f=!0;while(f){if(e){for(var g=0;g<e;g++){if(b[g]){var h=b[g];if(h&&h[0]&&" "!=h[0]){f=!1;g=e}}}}else{f=!1}if(f){for(var g=0,h;g<e;g++){h=b[g];b[g]=h.substr(1,h.length)}c=Q(c)}}a.matrix=b;a.matrixpositions=c;return a}function T(a){var b=a.matrix,c=a.matrixpositions,d=a.across,e=z(b)-1,f=b.length,g=!0;while(g){if(f){for(var h=0;h<f;h++){if(b[h]){var j=b[h];if(j[e]&&" "!=j[e]){g=!1;h=f}}}}else{g=!1}if(g){e--;for(var h=0,j;h<f;h++){j=b[h];b[h]=j.substr(0,j.length-1)}}}a.matrix=b;a.matrixpositions=c;return a}function U(a){for(var b=[],c=[],d=[],e=[],f=0;f<a.length;f++){var g=a[f],h=g[0].toLowerCase(),k=g[1];d[h]=k;var l=g[2];e[h]=l;Y[h]=k;var m=h+"-"+k,n=[];if(!c[m]){for(var o=V(h),p=[],q=f+1;q<a.length;q++){var r=a[q],s=r[0].toLowerCase(),t=r[1],u=s+"-"+t;if(!c[u]){var v=W(o,s);if(v&&v.length){o[v]--;c[u]=!0;p.push([s,v])}}}if(p.length){b[h]=p}else{n.push(h)}c[m]=!0}if(n.length){b["(unmatched)"]=n}}return{blocks:b,clues:d,fildnames:e}}function V(a){for(var b=[],c=0,d;c<a.length;c++){d=a[c];if(b[d]){b[d]++}else{b[d]=1}}return b}function W(a,b){for(var c="",d=0,e;d<b.length;d++){e=b[d];if(a[e]){return e}}return c}function X(a){var b=a.length,c,d;while(0!==b){d=Math.floor(Math.random()*b);b-=1;c=a[b];a[b]=a[d];a[d]=c}return a}(function(a){var b=a.length;if(!a||!b){console.log("Developer Error : Did you forget to load words?");return!1}var c=U(a),e=c.blocks,f=c.clues,i=c.fildnames,j=C(e);j=M(j);if(d()){j=X(j)}if(!j||!j.length){console.log("Developer Error : Your words could not be made into graphs.");return!1}var k=p(j),l=n(k.matrixpositions);m(k.matrix);h(l,f,i);g();return!0})(JSON.parse(b))}}});
//# sourceMappingURL=crossword.min.js.map
